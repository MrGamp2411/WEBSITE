{% extends "layout.html" %}
{% block content %}
<h1>Edit User {{ user.username }}</h1>
{% if error %}<div class="alert alert-danger">{{ error }}</div>{% endif %}
<form class="form" method="post" action="/admin/users/edit/{{ user.id }}">
  <label for="username">Username</label>
  <input id="username" name="username" type="text" value="{{ user.username }}" required>

  <label for="password">Password</label>
  <input id="password" name="password" type="password" placeholder="Leave blank to keep current">

  <label for="email">Email</label>
  <input id="email" name="email" type="email" value="{{ user.email }}" required>

  <label for="prefix">Prefix</label>
  <input id="prefix" name="prefix" type="text" value="{{ user.prefix }}">

  <label for="phone">Phone</label>
  <input id="phone" name="phone" type="tel" value="{{ user.phone }}">

  <label for="role">Role</label>
  {% if current.is_super_admin %}
  <select id="role" name="role">
    <option value="super_admin" {% if user.role=='super_admin' %}selected{% endif %}>Super Admin</option>
    <option value="bar_admin" {% if user.role=='bar_admin' %}selected{% endif %}>Bar Admin</option>
    <option value="bartender" {% if user.role=='bartender' %}selected{% endif %}>Bartender</option>
    <option value="customer" {% if user.role=='customer' %}selected{% endif %}>Customer</option>
  </select>

  <fieldset>
    <legend>Bars</legend>
    {% for b in bars %}
    <label><input type="checkbox" name="bar_ids" value="{{ b.id }}" {% if b.id in user.bar_ids %}checked{% endif %}> {{ b.name }}</label>
    {% endfor %}
  </fieldset>

  <label for="credit">Credit</label>
  <input id="credit" name="credit" type="number" step="0.01" value="{{ user.credit }}" required>
  {% else %}
  <select id="role" name="role">
    <option value="bar_admin" {% if user.role=='bar_admin' %}selected{% endif %}>Bar Admin</option>
    <option value="bartender" {% if user.role=='bartender' %}selected{% endif %}>Bartender</option>
  </select>
  <input type="hidden" name="credit" value="{{ user.credit }}">
  {% endif %}

  <button class="btn btn--primary" type="submit">Save</button>
</form>
{% endblock %}
