{% extends "layout.html" %}
{% block content %}
<h1>Edit User {{ user.username }}</h1>
{% if error %}<div class="alert alert-danger">{{ error }}</div>{% endif %}
<form class="form" method="post" action="/admin/users/edit/{{ user.id }}">
  <label for="username">Username</label>
  <input id="username" name="username" type="text" value="{{ user.username }}" required>

  <a class="btn-outline" href="/admin/users/{{ user.id }}/password">Edit Password</a>

  <label for="email">Email</label>
  <input id="email" name="email" type="email" value="{{ user.email }}" required>

  <label for="prefix">Prefix</label>
  <select id="prefix" name="prefix" autocomplete="tel-country-code">
    <option value="+41" {% if user.prefix == "+41" %}selected{% endif %}>+41 (Switzerland)</option>
    <option value="+1" {% if user.prefix == "+1" %}selected{% endif %}>+1 (USA)</option>
    <option value="+44" {% if user.prefix == "+44" %}selected{% endif %}>+44 (UK)</option>
  </select>

  <label for="phone">Phone</label>
  <input id="phone" name="phone" type="tel" value="{{ user.phone }}">

  <label for="role">Role</label>
  {% if current.is_super_admin %}
  <select id="role" name="role">
    <option value="super_admin" {% if user.role=='super_admin' %}selected{% endif %}>Super Admin</option>
    <option value="bar_admin" {% if user.role=='bar_admin' %}selected{% endif %}>Bar Admin</option>
    <option value="bartender" {% if user.role=='bartender' %}selected{% endif %}>Bartender</option>
    <option value="customer" {% if user.role=='customer' %}selected{% endif %}>Customer</option>
  </select>

  <fieldset>
    <legend>Bars</legend>
    {% for b in bars %}
    <label><input type="checkbox" name="bar_ids" value="{{ b.id }}" {% if b.id in user.bar_ids %}checked{% endif %}> {{ b.name }}</label>
    {% endfor %}
  </fieldset>

  <label for="add_credit">Add Credit</label>
  <input id="add_credit" name="add_credit" type="number" step="0.01" value="0">

  <label for="remove_credit">Remove Credit</label>
  <input id="remove_credit" name="remove_credit" type="number" step="0.01" value="0">
  {% else %}
  <select id="role" name="role">
    <option value="bar_admin" {% if user.role=='bar_admin' %}selected{% endif %}>Bar Admin</option>
    <option value="bartender" {% if user.role=='bartender' %}selected{% endif %}>Bartender</option>
  </select>
  <input type="hidden" name="add_credit" value="0">
  <input type="hidden" name="remove_credit" value="0">
  {% endif %}

  <button class="btn btn--primary" type="submit">Save</button>
</form>
{% endblock %}
