{% extends "layout.html" %}
{% block content %}
<h1>{{ bar.name }} Orders</h1>
<label><input type="checkbox" id="pause-ordering" {% if bar.ordering_paused %}checked{% endif %}> Pause ordering</label>
<div id="orders-section">
  <h2>Incoming Orders</h2>
  <div id="incoming-orders" class="order-list"></div>
  <h2>Preparing</h2>
  <div id="preparing-orders" class="order-list"></div>
  <h2>Ready</h2>
  <div id="ready-orders" class="order-list"></div>
  <h2>Completed</h2>
  <div id="completed-orders" class="order-list"></div>
</div>
<script src="/static/js/orders.js" defer></script>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    // start bartender WebSocket listener for live orders
    initBartender({{ bar.id }});
    const toggle = document.getElementById('pause-ordering');
    if (toggle) {
      toggle.addEventListener('change', () => {
        fetch(`/dashboard/bar/{{ bar.id }}/toggle_pause`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ paused: toggle.checked })
        });
      });
    }
  });
</script>
{% endblock %}
