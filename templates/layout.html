<!DOCTYPE html>
<html lang="{{ language_code }}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="theme-color" content="#ffffff">
  <meta name="color-scheme" content="light">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <title>{{ _('layout.meta.title', default='SiplyGo Prototype') }}</title>
  <meta name="description" content="{{ _('layout.meta.description', default='SiplyGo helps you discover bars nearby and manage your orders effortlessly.') }}">
  <link rel="canonical" href="https://siplygo.example.com/">
  <meta property="og:title" content="{{ _('layout.meta.title', default='SiplyGo Prototype') }}">
  <meta property="og:description" content="{{ _('layout.meta.og_description', default='Discover bars nearby and manage orders with SiplyGo.') }}">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://siplygo.example.com/">
  <meta property="og:image" content="/static/favicon.png">
  <meta name="twitter:card" content="summary_large_image">
  <link rel="icon" href="/static/favicon.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link href="/static/css/tokens.css" rel="stylesheet">
  <link href="/static/css/base.css" rel="stylesheet">
  <link href="/static/css/components.css" rel="stylesheet">
  <link href="/static/css/utilities.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  {% block page_styles %}{% endblock %}
</head>
<body data-cart-bar-id="{{ cart_bar_id or '' }}" data-current-bar-id="{{ current_bar_id or '' }}">
  <div class="site-bg" aria-hidden="true"></div>
  <header class="site-header" role="banner">
    {% if user and user.is_display %}
    <div class="display-header">
      <span class="hdr-logo">SiplyGo</span>
      <a href="/logout">{{ _('common.logout', default='Logout') }}</a>
    </div>
    {% else %}
    <div class="mobile-header">
      <!-- Premium hamburger trigger -->
      <button class="nav-toggle js-open-menu" aria-label="{{ _('layout.header.menu_button_aria', default='Menu') }}" aria-controls="mobileMenu" aria-expanded="false">
        <i class="bi bi-list" aria-hidden="true"></i>
        {% if unread_notifications %}
        <span class="notif-badge" aria-live="polite">{{ unread_notifications }}</span>
        {% endif %}
      </button>
      <a class="hdr-logo" href="/">SiplyGo</a>
      <div class="hdr-actions">
        {% if user and not (user.is_display or user.is_blocked or user.is_ip_blocked) %}
        <a class="credit-pill" href="/wallet" aria-label="{{ _('common.credits', default='Credits') }}">CHF {{ "%.2f"|format(user.credit) }}</a>
        {% endif %}
        {% if not user or (not user.is_display and not user.is_blocked and not user.is_ip_blocked) %}
        {% set cart_count_display = cart_count if cart_count else 0 %}
        <a class="cart-icon" href="/cart" aria-label="{{ _('layout.header.cart_aria', count=cart_count_display, default='Cart ({count} items)') }}">
          <i class="bi bi-cart2" aria-hidden="true"></i>
          <span class="cart-badge" aria-live="polite">{{ cart_count_display }}</span>
        </a>
        {% endif %}
      </div>
    </div>
    <nav aria-label="Primary" class="navbar desktop-nav">
      <button class="nav-toggle js-open-menu" aria-label="{{ _('layout.header.menu_button_aria', default='Menu') }}" aria-controls="mobileMenu" aria-expanded="false">
        <i class="bi bi-list" aria-hidden="true"></i>
        {% if unread_notifications %}
        <span class="notif-badge" aria-live="polite">{{ unread_notifications }}</span>
        {% endif %}
      </button>
      <a class="hdr-logo" href="/">SiplyGo</a>
      <div class="hdr-actions">
        {% if user and not (user.is_display or user.is_blocked or user.is_ip_blocked) %}
        <a class="credit-pill desktop-credit" href="/wallet" aria-label="{{ _('common.credits', default='Credits') }}">CHF {{ "%.2f"|format(user.credit) }}</a>
        {% endif %}
        {% if not user or (not user.is_display and not user.is_blocked and not user.is_ip_blocked) %}
        {% set cart_count_display = cart_count if cart_count else 0 %}
        <a class="cart-icon" href="/cart" aria-label="{{ _('layout.header.cart_aria', count=cart_count_display, default='Cart ({count} items)') }}">
          <i class="bi bi-cart2" aria-hidden="true"></i>
          <span class="cart-badge" aria-live="polite">{{ cart_count_display }}</span>
        </a>
        {% endif %}
      </div>
    </nav>
    <nav id="mobileMenu" class="mobile-menu" aria-label="Menu" role="dialog" aria-modal="true" hidden>
      <button class="menu-close js-close-menu" aria-label="{{ _('layout.header.close_menu_aria', default='Close menu') }}"><i class="bi bi-x" aria-hidden="true"></i></button>
      <a href="/search" role="menuitem"><i class="bi bi-geo-alt" aria-hidden="true"></i><span>{{ _('common.browse_bars', default='Browse Bars') }}</span></a>
      <button type="button" class="menu-language js-open-language" role="menuitem" data-keep-menu-open="true">
        <i class="bi bi-translate" aria-hidden="true"></i>
        <span>{{ _('layout.header.language', default='Language') }}</span>
        <span class="menu-language__code" aria-hidden="true">{{ language_code|upper }}</span>
      </button>
      {% if user and not (user.is_blocked or user.is_ip_blocked) and (user.is_super_admin or user.is_bar_admin or user.is_bartender) %}
      <a href="/dashboard" role="menuitem"><i class="bi bi-speedometer2" aria-hidden="true"></i><span>{{ _('common.dashboard', default='Dashboard') }}</span></a>
      {% endif %}
      {% if user %}
      {% if user.is_blocked or user.is_ip_blocked %}
      <a href="/notifications" role="menuitem"><i class="bi bi-bell" aria-hidden="true"></i><span>{{ _('common.notifications', default='Notifications') }}</span>{% if unread_notifications %}<span class="notif-badge" aria-live="polite">{{ unread_notifications }}</span>{% endif %}</a>
      {% else %}
      {% if not user.is_ip_blocked %}
      <a href="/wallet" role="menuitem"><i class="bi bi-wallet2" aria-hidden="true"></i><span>{{ _('common.wallet', default='Wallet') }}</span></a>
      <a href="/orders" role="menuitem"><i class="bi bi-clock-history" aria-hidden="true"></i><span>{{ _('common.orders', default='Orders') }}</span></a>
      {% endif %}
      <a href="/notifications" role="menuitem"><i class="bi bi-bell" aria-hidden="true"></i><span>{{ _('common.notifications', default='Notifications') }}</span>{% if unread_notifications %}<span class="notif-badge" aria-live="polite">{{ unread_notifications }}</span>{% endif %}</a>
      <a href="/profile" role="menuitem"><i class="bi bi-person" aria-hidden="true"></i><span>{{ _('common.profile', default='Profile') }}</span></a>
      <a href="/logout" role="menuitem"><i class="bi bi-box-arrow-right" aria-hidden="true"></i><span>{{ _('common.logout', default='Logout') }}</span></a>
      {% endif %}
      {% else %}
      <a href="/login" role="menuitem" class="menu-login"><i class="bi bi-box-arrow-in-right" aria-hidden="true"></i><span>{{ _('common.login', default='Login') }}</span></a>
      <a href="/register" role="menuitem" class="menu-register"><i class="bi bi-person-plus" aria-hidden="true"></i><span>{{ _('common.register', default='Register') }}</span></a>
      {% endif %}
    </nav>
    <div class="language-backdrop menu-backdrop" hidden></div>
    <div id="languageDialog" class="language-dialog" role="dialog" aria-modal="true" aria-labelledby="languageDialogTitle" hidden>
      <div class="language-dialog__panel">
        <button type="button" class="language-dialog__close js-close-language" aria-label="{{ _('common.close', default='Close') }}">
          <i class="bi bi-x" aria-hidden="true"></i>
        </button>
        <h2 id="languageDialogTitle" class="language-dialog__title">{{ _('layout.language.title', default='Choose language') }}</h2>
        <p class="language-dialog__subtitle">{{ _('layout.language.subtitle', default='Select your preferred language for the app.') }}</p>
        <div class="language-dialog__options" role="radiogroup" aria-labelledby="languageDialogTitle">
          {% for lang in available_languages %}
          <button type="button" class="language-option" data-lang="{{ lang.code }}" role="radio" aria-checked="{{ 'true' if language_code == lang.code else 'false' }}">
            <span class="language-option__name">{{ lang.name }}</span>
            <span class="language-option__meta">
              {% if language_code == lang.code %}
              <i class="bi bi-check-lg" aria-hidden="true"></i>
              <span class="visually-hidden">{{ _('layout.language.current', default='Currently selected') }}</span>
              {% else %}
              {{ lang.code|upper }}
              {% endif %}
            </span>
          </button>
          {% endfor %}
        </div>
      </div>
    </div>
    {% endif %}
  </header>
  <div class="menu-backdrop" hidden></div>
  <main id="main" class="container">
      {% block content %}{% endblock %}
  </main>
    {% if not user or not user.is_display %}
    <footer class="site-footer" role="contentinfo">
      <div class="container">
        <p>{{ _('layout.footer.copyright', default='SiplyGo © 2025') }} · <a href="/about">{{ _('layout.footer.about', default='About') }}</a> · <a href="/help-center">{{ _('layout.footer.help_center', default='Help Center') }}</a> · <a href="/for-bars">{{ _('layout.footer.for_bars', default='For Bars') }}</a> · <a href="/terms">{{ _('layout.footer.terms', default='Terms') }}</a></p>
      </div>
    </footer>
    <div id="cartBlocker" class="cart-blocker" {% if cart_bar_id and current_bar_id != cart_bar_id %}{% else %}hidden{% endif %}>
      <div class="cart-popup">
        <p>{{ _('layout.cart_blocker.message', bar_name=cart_bar_name, default='You still have products in your cart at <strong>{bar_name}</strong>.')|safe }}</p>
        <div class="cart-popup-actions">
          <button type="button" class="btn btn--secondary js-clear-cart">{{ _('layout.cart_blocker.remove', default='Remove products') }}</button>
          <a class="btn btn--primary" href="/bars/{{ cart_bar_id }}">{{ _('layout.cart_blocker.go_to_menu', default='Go to the bar menu') }}</a>
        </div>
      </div>
    </div>
    <div id="servicePaused" class="cart-blocker" hidden>
      <div class="cart-popup">
        <p>{{ _('layout.service_paused.message', bar_name=cart_bar_name, default='Ordering is paused for <strong>{bar_name}</strong>. Please contact a staff member for more information.')|safe }}</p>
        <div class="cart-popup-actions">
          {% if pause_popup_close|default(False) %}
          <button type="button" class="btn btn--secondary js-close-service-paused">{{ _('layout.service_paused.close', default='Close') }}</button>
          {% endif %}
          {% if pause_popup_back|default(False) %}
          <a class="btn btn--primary" href="/bars/{{ cart_bar_id }}">{{ _('layout.service_paused.back', default='Back to the menu') }}</a>
          {% endif %}
        </div>
      </div>
    </div>
    <script id="layoutState" type="application/json">
      {{ {'orderingPaused': cart_bar_paused|default(False), 'showServicePausedOnLoad': show_service_paused|default(False)}|tojson }}
    </script>
    {% endif %}
  <script id="appI18nData" type="application/json">
{
  "notices": {
    "payment_failed": {
      "title": {{ _('notices.payment_failed.title', default='Payment failed')|tojson }},
      "body": {{ _('notices.payment_failed.body', default='Payment was not successful. Please try again or contact our staff if the problem persists.')|tojson }},
      "close": {{ _('common.close', default='Close')|tojson }}
    },
    "wallet_insufficient": {
      "title": {{ _('notices.wallet_insufficient.title', default='Add wallet credit')|tojson }},
      "body": {{ _('notices.wallet_insufficient.body', default="You don't have enough wallet credit to complete this order. Top up your wallet or choose another payment method.")|tojson }},
      "close": {{ _('common.close', default='Close')|tojson }}
    }
  },
  "app": {
    "open_label": {{ _('home.bar_card.open_label', bar_name='{bar}', default='Open {bar}')|tojson }}
  },
  "orders": {
    "card": {
      "title": {{ _('order_history.card.title', code='{code}', default='Order {code}')|tojson }},
      "status_aria": {{ _('order_history.card.status_aria', status='{status}', default='Order status: {status}')|tojson }},
      "fields": {
        "total": {{ _('order_history.card.fields.total', default='Total')|tojson }},
        "refunded": {{ _('order_history.card.fields.refunded', default='Refunded')|tojson }},
        "placed": {{ _('order_history.card.fields.placed', default='Placed')|tojson }},
        "customer": {{ _('order_history.card.fields.customer', default='Customer')|tojson }},
        "bar": {{ _('order_history.card.fields.bar', default='Bar')|tojson }},
        "table": {{ _('order_history.card.fields.table', default='Table')|tojson }},
        "payment": {{ _('order_history.card.fields.payment', default='Payment')|tojson }},
        "cancellation_reason": {{ _('order_history.card.fields.cancellation_reason', default='Cancellation reason')|tojson }},
        "notes": {{ _('order_history.card.fields.notes', default='Notes')|tojson }},
        "prep_time": {{ _('order_history.card.fields.prep_time', default='Prep time')|tojson }}
      },
      "unknown_customer": {{ _('order_history.card.unknown_customer', default='Unknown')|tojson }},
      "prep_minutes": {{ _('order_history.card.prep_minutes', minutes='{minutes}', default='{minutes} min')|tojson }},
      "cancellation_reasons": {
        "bartender": {{ _('order_history.card.cancellation_reasons.bartender', default='Canceled by bartender')|tojson }},
        "customer": {{ _('order_history.card.cancellation_reasons.customer', default='Canceled by customer')|tojson }},
        "timeout": {{ _('order_history.card.cancellation_reasons.timeout', default='Not prepared in time')|tojson }}
      }
    },
    "actions": {
      "accept": {{ _('bartender_orders.actions.accept', default='Accept')|tojson }},
      "cancel": {{ _('order_history.sections.pending.actions.cancel', default='Cancel')|tojson }},
      "ready": {{ _('bartender_orders.actions.ready', default='Ready')|tojson }},
      "complete": {{ _('bartender_orders.actions.complete', default='Complete')|tojson }},
      "reorder": {{ _('order_history.sections.completed.actions.reorder', default='Reorder')|tojson }}
    },
    "statuses": {
{% if not (user and user.is_display) %}
      "PLACED": {{ _('orders.statuses.placed', default='Placed')|tojson }},
      "ACCEPTED": {{ _('orders.statuses.accepted', default='Accepted')|tojson }},
      "READY": {{ _('orders.statuses.ready', default='Ready')|tojson }},
      "COMPLETED": {{ _('orders.statuses.completed', default='Completed')|tojson }},
      "CANCELED": {{ _('orders.statuses.canceled', default='Canceled')|tojson }},
      "REJECTED": {{ _('orders.statuses.rejected', default='Rejected')|tojson }}
{% endif %}
    },
    "payment_methods": {
{% if not (user and user.is_display) %}
      "card": {{ _('orders.payment_methods.card', default='Card')|tojson }},
      "credit_card": {{ _('orders.payment_methods.credit_card', default='Credit Card')|tojson }},
      "wallet": {{ _('orders.payment_methods.wallet', default='Wallet')|tojson }},
      "bar": {{ _('orders.payment_methods.bar', default='Pay at bar')|tojson }}
{% endif %}
    }
  },
  "display": {
    "card_title": {{ _('display_orders.card.title', code='{code}', default='Order {code}')|tojson }}
  }
}
  </script>
  <script src="/static/js/layout.js" defer></script>
  <script src="/static/js/app.min.js" defer></script>
  {% block scripts %}{% endblock %}
</body>
</html>

