{% extends "layout.html" %}
{% block content %}
<section class="profile-page">
  <div class="profile-card">
    <div class="profile-head">
      <h1 class="profile-title">{{ _('profile.title', default='Profile') }}</h1>
      <p class="profile-subtitle">{{ _('profile.subtitle', default='Manage your account, security, and phone number.') }}</p>
    </div>
    {% if success %}<p class="alert alert-success">{{ _('profile.alerts.success', default='Profile updated successfully.') }}</p>{% endif %}
    {% if error %}<p class="alert alert-danger">{{ error }}</p>{% endif %}
    <form method="post" action="/profile" id="profile-form" class="profile-form">
      <div class="form-grid">
        <div class="field" data-name="username">
          <label for="username" class="block-label">{{ _('profile.fields.username.label', default='Username') }}</label>
          <div class="input-with-icon">
            <input id="username" type="text" name="username" required autocomplete="username" inputmode="text" enterkeyhint="next" minlength="3" maxlength="24" pattern="(?![._-])(?!.*[._-]{2})(?!.*[._-]$)[a-z0-9._-]{3,24}" title="{{ _('profile.fields.username.title', default='3â€“24 characters, lowercase letters, numbers, dot, hyphen or underscore. No spaces.') }}" value="{{ username|default(user.username) }}" disabled>
            <button type="button" class="edit-btn icon" aria-label="{{ _('profile.aria.edit_username', default='Edit username') }}"><i class="bi bi-pencil-square"></i></button>
          </div>
        </div>
        <div class="field" data-name="email">
          <label for="email" class="block-label">{{ _('profile.fields.email.label', default='Email') }}</label>
          <div class="input-with-icon">
            <input id="email" type="email" name="email" required autocomplete="email" inputmode="email" enterkeyhint="next" pattern="[^@]+@[^@]+\.[^@]+" title="{{ _('profile.fields.email.title', default='Email must be in the format text@text.text') }}" value="{{ email|default(user.email) }}" disabled>
            <button type="button" class="edit-btn icon" aria-label="{{ _('profile.aria.edit_email', default='Edit email') }}"><i class="bi bi-pencil-square"></i></button>
          </div>
        </div>
        <div class="field" data-name="prefix">
          <label for="prefix" class="block-label">{{ _('profile.fields.prefix.label', default='Phone Prefix') }}</label>
          <div class="input-with-icon">
            <select id="prefix" name="prefix" required autocomplete="tel-country-code" disabled>
              <option value="+41" {% if (prefix|default(user.prefix)) == "+41" %}selected{% endif %}>{{ _('register.options.ch', default='+41 (Switzerland)') }}</option>
              <option value="+39" {% if (prefix|default(user.prefix)) == "+39" %}selected{% endif %}>{{ _('register.options.it', default='+39 (Italy)') }}</option>
              <option value="+49" {% if (prefix|default(user.prefix)) == "+49" %}selected{% endif %}>{{ _('register.options.de', default='+49 (Germany)') }}</option>
              <option value="+33" {% if (prefix|default(user.prefix)) == "+33" %}selected{% endif %}>{{ _('register.options.fr', default='+33 (France)') }}</option>
            </select>
            <button type="button" class="edit-btn icon" aria-label="{{ _('profile.aria.edit_prefix', default='Edit phone prefix') }}"><i class="bi bi-pencil-square"></i></button>
          </div>
        </div>
        <div class="field" data-name="phone">
          <label for="phone" class="block-label">{{ _('profile.fields.phone.label', default='Phone Number') }}</label>
          <div class="input-with-icon">
            <input id="phone" type="tel" name="phone" required autocomplete="tel-national" inputmode="tel" enterkeyhint="done" pattern="[0-9]{9,10}" minlength="9" maxlength="10" title="{{ _('profile.fields.phone.title', default='Phone number must be 9 to 10 digits') }}" value="{{ phone|default(user.phone) }}" disabled>
            <button type="button" class="edit-btn icon" aria-label="{{ _('profile.aria.edit_phone', default='Edit phone number') }}"><i class="bi bi-pencil-square"></i></button>
          </div>
          <small class="help">{{ _('profile.help.phone', default='Use mobile format for your country.') }}</small>
          <a class="btn btn--secondary change-password" href="/profile/password">{{ _('profile.actions.change_password', default='Change Password') }}</a>
        </div>
      </div>
      <div class="form-actions">
        <button class="btn btn--primary" type="submit">{{ _('profile.actions.save', default='Save') }}</button>
      </div>
    </form>
  </div>
</section>
{% endblock %}

{% block scripts %}
<script src="/static/js/profile.js" defer></script>
{% endblock %}
