{% extends "layout.html" %}
{% block content %}
<h1>{{ bar.name }} - Orders for {{ closing.closed_at|format_time }}</h1>
<p>Total revenue: CHF {{ "%.2f"|format(closing.total_revenue) }}</p>
<div class="order-list">
  {% for order in orders %}
  <article class="order-card card card--{{ order.status|lower }}" role="article" aria-labelledby="order-{{ order.id }}-title" data-status="{{ order.status }}">
    <header class="order-card__header">
      <h3 id="order-{{ order.id }}-title">Order #{{ order.id }}</h3>
      <span class="order-status chip status status-{{ order.status|lower }}" aria-label="Order status: {{ order.status|replace('_', ' ')|title }}">{{ order.status|replace('_', ' ')|title }}</span>
    </header>
    <div class="order-card__divider"></div>
    <section class="order-card__meta">
      <dl class="order-kv">
        <div><dt>Customer</dt><dd>{{ order.customer_name or 'Unknown' }} <span class="muted">({{ order.customer_prefix or '' }} {{ order.customer_phone or '' }})</span></dd></div>
        <div><dt>Table</dt><dd>{{ order.table_name or '' }}</dd></div>
        <div><dt>Payment</dt><dd>{{ order.payment_method.replace('_', ' ')|title if order.payment_method else '' }}</dd></div>
        <div><dt>Total</dt><dd class="num">CHF {{ "%.2f"|format(order.total) }}</dd></div>
        <div><dt>Placed</dt><dd class="num">{{ order.created_at|format_time }}</dd></div>
        {% if order.ready_at %}<div><dt>Prep time</dt><dd class="num">{{ ((order.ready_at - order.created_at).total_seconds() // 60)|int }} min</dd></div>{% endif %}
      </dl>
    </section>
    <div class="order-card__divider"></div>
    <section class="order-card__items">
      <ul class="order-items">
        {% for item in order.items %}
        <li><span class="qty">{{ item.qty }}Ã—</span><span class="name">{{ item.menu_item_name or 'Unknown item' }}</span></li>
        {% endfor %}
      </ul>
    </section>
  </article>
  {% else %}
  <p>No orders.</p>
  {% endfor %}
</div>
{% endblock %}
