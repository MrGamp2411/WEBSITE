{% extends "layout.html" %}
{% block content %}
<section class="profile-page change-password-page">
  <div class="profile-card">
    <div class="profile-head">
      <h1 class="profile-title">{{ _('change_password.title', default='Change Password') }}</h1>
      <p class="profile-subtitle">{{ _('change_password.subtitle', default='Update your account password.') }}</p>
    </div>
    {% if success %}<p class="alert alert-success">{{ _('change_password.alerts.success', default='Password updated successfully.') }}</p>{% endif %}
    {% if error %}<p class="alert alert-danger">{{ error }}</p>{% endif %}
    <form method="post" action="/profile/password" class="profile-form">
      <div class="form-grid">
        <div class="field" data-name="current-password">
          <label for="current_password" class="block-label">{{ _('change_password.fields.current_password.label', default='Current Password') }}</label>
          <div class="password-wrapper input-with-icon">
            <input id="current_password" type="password" name="current_password" autocomplete="current-password" enterkeyhint="next" minlength="8" maxlength="128" title="{{ _('change_password.fields.current_password.title', default='Password must be between 8 and 128 characters') }}">
            <button type="button" class="toggle-password icon" aria-label="{{ _('auth.password_toggle.show', default='Show password') }}" data-show-label="{{ _('auth.password_toggle.show', default='Show password') }}" data-hide-label="{{ _('auth.password_toggle.hide', default='Hide password') }}"><i class="bi bi-eye"></i></button>
          </div>
          <span id="capsWarningCurrent" class="caps-warning" hidden>{{ _('auth.caps_warning', default='Caps Lock is on') }}</span>
        </div>
        <div class="field" data-name="new-password">
          <label for="password" class="block-label">{{ _('change_password.fields.new_password.label', default='New Password') }}</label>
          <div class="password-wrapper input-with-icon">
            <input id="password" type="password" name="password" autocomplete="new-password" enterkeyhint="next" minlength="8" maxlength="128" title="{{ _('change_password.fields.new_password.title', default='Password must be between 8 and 128 characters') }}">
            <button type="button" class="toggle-password icon" aria-label="{{ _('auth.password_toggle.show', default='Show password') }}" data-show-label="{{ _('auth.password_toggle.show', default='Show password') }}" data-hide-label="{{ _('auth.password_toggle.hide', default='Hide password') }}"><i class="bi bi-eye"></i></button>
          </div>
          <span id="capsWarning" class="caps-warning" hidden>{{ _('auth.caps_warning', default='Caps Lock is on') }}</span>
          <small class="help">{{ _('change_password.help.strength', default='Use 8+ characters with letters & numbers.') }}</small>
        </div>
        <div class="field" data-name="confirm-password">
          <label for="confirm_password" class="block-label">{{ _('change_password.fields.confirm_password.label', default='Confirm Password') }}</label>
          <div class="password-wrapper input-with-icon">
            <input id="confirm_password" type="password" name="confirm_password" autocomplete="new-password" enterkeyhint="done" minlength="8" maxlength="128" title="{{ _('change_password.fields.confirm_password.title', default='Passwords must match') }}" data-mismatch-message="{{ _('auth.password_mismatch', default='Passwords must match') }}">
            <button type="button" class="toggle-password icon" aria-label="{{ _('auth.password_toggle.show', default='Show password') }}" data-show-label="{{ _('auth.password_toggle.show', default='Show password') }}" data-hide-label="{{ _('auth.password_toggle.hide', default='Hide password') }}"><i class="bi bi-eye"></i></button>
          </div>
          <span id="capsWarningConfirm" class="caps-warning" hidden>{{ _('auth.caps_warning', default='Caps Lock is on') }}</span>
        </div>
      </div>
      <div class="sticky-actions">
        <button class="btn btn--primary" type="submit">{{ _('change_password.actions.save', default='Save') }}</button>
      </div>
    </form>
  </div>
</section>
{% endblock %}
{% block scripts %}
<script src="/static/js/password.js" defer></script>
{% endblock %}
