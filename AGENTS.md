# AGENT Notes

- Core modules:
  - `main.py` – routes and helpers
  - `models.py` – data models
  - `database.py` – database utilities
- Front-end mapping:
  - Styles in `static/css/components.css` (`components.min.css` for minified)
  - Templates live under `templates/`
  - JavaScript: `static/js/app.js` (shared/carousels), `static/js/search.js`, `static/js/view-all.js`
  - Bar & product card size: 400×450 desktop, 300×400 mobile
- Bars:
  - `/bars` page uses `templates/all_bars.html` and `static/js/view-all.js`
  - `BAR_CATEGORIES` defined in `main.py`; reused in `search.js` and `view-all.js`
  - Categories stored in `bars.bar_categories`
  - Opening hours data is sanitized; invalid or non-dict values are treated as closed
  - Category `sort_order` defaults to `0` when missing to avoid menu sorting errors
  - Bar detail page uses bar-card metadata for rating and geolocated distance
  - Bar detail page displays the bar's description beneath the address
  - Bar detail page shows open/closed status using `bar.is_open_now`
- Bar detail page lists weekly opening hours beneath the description
- Bar detail info is rendered in `.bar-detail` (no card styling)
- Bar detail uses reusable macros in `templates/components/bar_components.html`
- Additional JS for bar detail interactions in `static/js/bar_detail.js`
- Bar model includes `rating_count` and `photos` fields; photos stored as JSON lists
- Products:
  - Images stored in `menu_items.photo` and served via `/api/products/{id}/image`
  - `templates/bar_detail.html` shows products with carousels handled by `static/js/app.js`
- Users:
  - Credit stored in `users.credit`; ensured by `ensure_credit_column()` on startup
- Testing:
  - Run `pytest`
